# 代码整洁之道

- 尽量减少依赖，使之便于维护
- 整洁的代码只做好一件事
- 命名规范统一 有意义的命名
- 代码应该做到尽量少
- 测试驱动开发

简单代码规则:
- 能通过所以测试
- 没有重复代码
- 体现系统中的全部设计理念
- 包括尽量少的实体，比如类、方法、函数等

> 不要重复代码，只做一件事，小规模抽象

## 有意义的命名
- 名副其实
- 避免误导
- 做有意义的区分
- 使用读得出来的名称
- 使用可搜索的名称
- 避免使用编码
- 每个概念对应一个词
- 别用双关语
- 使用解决方案领域的名称
- 使用源自所涉问题领域的名称
- 添加有意义的语境
- 不要添加没用的语境

## 函数
- 函数应该尽量短小
- 只做好一件事
- 每个函数一个抽象层级
- 使用描述性的名称
- 使用异常代替返回错误码
- 别重复自己

## 注释
- 注释不能美化糟糕的代码
- 好的代码是最好的注释
- 对意图的解释
- 阐释
- 警示
- TODO注释
- 不要写多余的注释
- 误导性注释
- 废话注释
- 注释掉的代码是很讨厌的做法，别这么干

## 格式
- 遵循各语言的编码规范 如Python的pep8

## 对象和数据结构
- 得墨忒耳律
   > 模块不应该了解它所操作对象的内容情况。对象隐藏数据，暴露操作。

## 错误处理
- 使用异常而非返回码
- 依据调用者需要定义异常类

## 边界问题
- 整洁的边界，在我们使用第三方代码时，必须加倍小心，确保未来的修改不至于代价太大

## 单元测试

### TDD三定律
- 在编写不能通过的单元测试前，不可编写生产代码
- 只可编写刚好无法通过的单元测试，不能也算不通过
- 只可编程刚好足以通过当前失败测试的生产代码

### 保持测试整洁
(整洁的测试还遵循以下5条规则)
- 快速  (测试应该能够快速运行)
- 独立 (测试应该相互独立)
- 可重复 (测试应该在任何环境中重复通过)
- 自足验证 (测试应该有布尔值输出)
- 及时 (测试应该及时编写)


## 类
- 类的组织 (封装)
- 类应该短小
- 单一职责原则
- 内聚
- 保持内聚性就会得到许多短小的类
- 隔离修改


## 系统
- 将系统的构造与使用分开

## 迭进
- 运行所有测试
- 重构
- 不可重复 (重复是拥有良好设计系统的大敌)
- 尽可能少的类和方法

## 并发编程
### 并发防御机制
- 单一职责原则
- 了解执行模型 (限制资源、互斥、线程饥饿、死锁、活锁)
- 生产者－消费者模型
- 读者－作者模型

## 味道和启发
### 注释
- 不恰当的信息
- 废弃的注释
- 冗余的注释
- 糟糕的注释
- 注释掉的代码

### 环境
- 需要多步才能实现的构建
- 需要多步才能做到的测试

### 函数
- 过多的参数
- 死函数 (永远不被调用的函数)

### 一般性问题
- 忽视安全
- 重复
- 不正确的边界行为
- 信息过多
- 死代码 (不被执行的代码)
- 前后不一致
